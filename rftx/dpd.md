---
# Deep Dive into DPD (Digital Predistortion)

## 1. What DPD Actually Does
- PA distorts the signal.  
- DPD applies the **inverse distortion** before the PA so the final output becomes linear.  
- Concept:  
  **DPD distortion + PA distortion = clean output.**

---

## 2. DPD Is a Mathematical Model of the PA
DPD builds:
- A **behavioral model** of PA nonlinearities.  
- An **inverse model** to cancel them.

It captures:
- AM-AM distortion  
- AM-PM distortion  
- Memory effects  
- Frequency-dependent changes  
- Nonlinearity variation with power

---

## 3. DPD Uses a Feedback Loop
- A small portion of PA output is fed back through a coupler.  
- Compared with the original signal.  
- DPD coefficients adapt continuously.

This is needed because PA behavior changes with:
- Temperature  
- Supply voltage  
- Device aging  
- Load impedance / antenna VSWR  
- Frequency  
- Output power

DPD is **adaptive**, not static.

---

## 4. The Polynomial Magic (Nonlinearity Orders)
DPD uses nonlinear polynomial terms:
- 3rd-order  
- 5th-order  
- 7th-order  
- Up to 9th or 11th for wideband GaN PAs

These counter the PA’s distortion orders generated by OFDM peaks.

---

## 5. Memory Effects: The Tough Part
Memory effects arise from:
- Thermal dynamics  
- Bias network time constants  
- Device capacitances  
- GaN trapping effects  
- Doherty load modulation varying with frequency

DPD handles this using:
- **Memory polynomials**  
- **Dynamic terms**  
- **Frequency-dependent corrections**

This is what makes wideband DPD complex.

---

## 6. CFR & DPD — Best Friends
CFR (Crest Factor Reduction):
- Reduces PAPR  
- Allows less PA back-off  
- Improves efficiency  
- Makes DPD more effective

CFR feeds into DPD; they always work together.

---

## 7. DPD Must Work Across Wide Bandwidth
For N78 (100–300+ MHz BW):
- Distortion varies across frequency  
- Memory effects become stronger  
- Higher polynomial orders needed  
- Coefficient adaptation must be fast

Wideband DPD is one of the hardest design challenges.

---

## 8. Implementation Platforms
DPD typically runs on:
- **FPGA fabric**  
- **ASIC DSP engines**  
- **High-performance DSP cores**

It must handle high sample rates in real time.

---

## 9. Key Outputs of DPD
DPD improves:
- **ACLR** (e.g., –30 dBc → –50 dBc)  
- **EVM**  
- **Usable PA power**  
- **Overall efficiency (PAE)**  
- **Spectral cleanliness**

---

## 10. The Real DPD Structure (Intuitive)
DPD(x) is basically:


DPD pre-bends the waveform → PA unbends it.
DPD(x) = x + Σ (coeff × x^n) + memory terms
then
PA(DPD(x)) ≈ x   (linear output)
---

## 11. DPD for Doherty PAs (VERY Important)
Doherty PAs have:
- Strong AM-AM distortion  
- Strong AM-PM distortion  
- Load modulation dependent on frequency  
- Highly nonlinear peaking region

DPD must:
- Use high nonlinear order  
- Include strong memory correction  
- Continuously adapt  
- Address main/aux path asymmetry

Doherty PAs **cannot** meet 5G specs without DPD.

---